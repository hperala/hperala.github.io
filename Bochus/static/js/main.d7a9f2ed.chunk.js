(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},19:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),l=a(8),c=a.n(l),r=(a(15),a(17),a(2)),s=a(3),o=a(6),u=a(4),m=a(5),d=a(1),h=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return null===this.props.reviews?i.a.createElement("div",null):i.a.createElement("div",{className:"Goodreads"},i.a.createElement("p",null,"Arvosana Goodreads-sivustolla:",i.a.createElement("br",null),this.formatRating(this.props.reviews.AverageRating),"/5"),i.a.createElement("div",{className:"ReviewsWrapper",dangerouslySetInnerHTML:{__html:this.props.reviews.ReviewsHtml}}))}},{key:"formatRating",value:function(e){return e.toLocaleString("fi-FI",{minimumFractionDigits:2,maximumFractionDigits:2})}}]),t}(n.Component),v="https://bochus.azurewebsites.net",b={RECOMMENDATIONS_ENDPOINT:v+"/api/Recommendations",searchReviewsUrl:function(e){return"".concat(v,"/api/Items/SearchReviews?id=").concat(e)},getReviewsUrl:function(e){return"".concat(v,"/api/Items/Reviews?gr_book_id=").concat(e)},THUMBNAILS_BASE_URL:v+"/Content/Thumbnails/",FINNA_BASE_URL:"https://heili.finna.fi",DELAY_MILLIS:1500},f=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"setDefaults",value:function(e){null===e.Locations&&(e.Locations=[]),null===e.Subjects&&(e.Subjects=[])}},{key:"render",value:function(){var e=this.props.item;if(null===e)return i.a.createElement("div",{className:"Details",hidden:!0});this.setDefaults(e);var t=e.Subjects.map(function(e){return e.FullText}).join(" | "),a=e.Locations.map(function(e){return i.a.createElement("li",{key:e.ID},e.Name)}),n=b.FINNA_BASE_URL+e.ExternalRelativeUrl;return i.a.createElement("div",{className:"Details card",hidden:this.props.hidden},i.a.createElement("div",{className:"card-body"},i.a.createElement("button",{className:"DetailsCloseButton btn",onClick:this.props.handleCloseButtonClicked},"\xd7"),i.a.createElement("h3",null,i.a.createElement("span",{className:"AuthorName"},e.AuthorName),i.a.createElement("br",null),e.Title),i.a.createElement("div",null,e.PublicationYear),i.a.createElement("div",null,e.Series),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md"},i.a.createElement("p",{className:"Subjects"},t),i.a.createElement("p",null,"Heili-kirjastot, joiden kokoelmiin nimike kuuluu:"),i.a.createElement("ul",null,a),i.a.createElement("p",null,"Tarkista t\xe4m\xe4nhetkinen saatavuus ",i.a.createElement("a",{href:n},"Finnasta"),".")),i.a.createElement("div",{className:"col-md"},i.a.createElement(h,{reviews:this.props.reviews})))))}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).clicked=a.clicked.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"clicked",value:function(e){this.props.handleClick(this.props.item)}},{key:"render",value:function(){var e=this.props.item;return i.a.createElement("img",{key:e.ID,src:b.THUMBNAILS_BASE_URL+e.ExternalID+".png",className:"Thumbnail img-fluid img-thumbnail",alt:e.Title,onClick:this.clicked})}}]),t}(n.Component),p=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={detailsHidden:!0,detailsItem:null,reviews:null},a.handleThumbnailClick=a.handleThumbnailClick.bind(Object(d.a)(Object(d.a)(a))),a.handleDetailsCloseButtonClicked=a.handleDetailsCloseButtonClicked.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"handleThumbnailClick",value:function(e){this.setState({detailsHidden:!1,detailsItem:e,reviews:null}),this.getReviewsID(e)}},{key:"handleDetailsCloseButtonClicked",value:function(e){this.setState({detailsHidden:!0,detailsItem:null})}},{key:"render",value:function(){var e=this,t=this.props.category.Items.map(function(t){return i.a.createElement(k,{key:t.ID,item:t,handleClick:e.handleThumbnailClick})});return i.a.createElement("div",{className:"Category"},i.a.createElement("h2",null,this.props.category.Name),i.a.createElement("div",{className:"Slider"},t),i.a.createElement(f,{item:this.state.detailsItem,reviews:this.state.reviews,hidden:this.state.detailsHidden,handleCloseButtonClicked:this.handleDetailsCloseButtonClicked}))}},{key:"getReviewsID",value:function(e){var t=this,a=b.searchReviewsUrl(e.ID);console.log(a),fetch(a).then(function(e){if(e.ok)return e.json();throw new Error("Request failed: "+e.status)}).then(function(e){console.log(e),e.NumResults>0&&setTimeout(function(){t.getReviews(e)},b.DELAY_MILLIS)}).catch(function(e){console.log("Error retrieving data: ",e.message)})}},{key:"getReviews",value:function(e){var t=this,a=b.getReviewsUrl(e.BestMatch.BookID);console.log(a),fetch(a).then(function(e){if(e.ok)return e.json();throw new Error("Request failed: "+e.status)}).then(function(e){console.log(e),t.setState({reviews:e.Reviews})}).catch(function(e){console.log("Error retrieving data: ",e.message)})}}]),t}(n.Component),g=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("h2",null,"Tietoja Bochus-palvelusta"),i.a.createElement("p",null,"Afjdgkl gfjalk djgkljdfkls"),i.a.createElement("p",null,"Afjdgkl gfjalk djgkljdfkls"))}}]),t}(n.Component),E=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"handleClick",value:function(e){this.props.handleOpenPage(e.currentTarget.dataset.target)}},{key:"render",value:function(){return i.a.createElement("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},i.a.createElement("a",{className:"navbar-brand",onClick:this.handleClick,"data-target":"MainPage",href:"#"},"Bochus"),i.a.createElement("ul",{className:"navbar-nav mr-auto"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link",onClick:this.handleClick,"data-target":"AboutPage",href:"#"},"Tietoja"))))}}]),t}(n.Component),j=(a(19),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={categories:[],activePage:"MainPage"},a.setActivePage=a.setActivePage.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"setActivePage",value:function(e){this.setState({activePage:e})}},{key:"componentDidMount",value:function(){var e=this;fetch(b.RECOMMENDATIONS_ENDPOINT).then(function(e){if(e.ok)return e.json();throw new Error("Request failed")}).then(function(t){e.setState({categories:t})}).catch(function(e){console.log("Error retrieving data: ",e.message)})}},{key:"render",value:function(){var e=this.state.categories.map(function(e){return i.a.createElement(p,{key:e.Name,category:e})});return i.a.createElement("div",{className:"App container"},i.a.createElement(E,{handleOpenPage:this.setActivePage}),i.a.createElement("div",{id:"MainPage",hidden:"MainPage"!==this.state.activePage},e),i.a.createElement("div",{id:"AboutPage",hidden:"AboutPage"!==this.state.activePage},i.a.createElement(g,null)))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,a){e.exports=a(21)}},[[9,2,1]]]);
//# sourceMappingURL=main.d7a9f2ed.chunk.js.map