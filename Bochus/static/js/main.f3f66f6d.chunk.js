(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},19:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),l=a(8),s=a.n(l),r=(a(15),a(17),a(2)),c=a(3),o=a(6),u=a(4),m=a(5),h=a(1),d=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return null===this.props.reviews?i.a.createElement("div",null):i.a.createElement("div",{className:"Goodreads"},i.a.createElement("p",null,"Arvosana Goodreads-sivustolla:",i.a.createElement("br",null),this.formatRating(this.props.reviews.AverageRating),"/5"),i.a.createElement("div",{className:"ReviewsWrapper",dangerouslySetInnerHTML:{__html:this.props.reviews.ReviewsHtml}}))}},{key:"formatRating",value:function(e){return e.toLocaleString("fi-FI",{minimumFractionDigits:2,maximumFractionDigits:2})}}]),t}(n.Component),v="https://bochus.azurewebsites.net",k={RECOMMENDATIONS_ENDPOINT:v+"/api/Recommendations",searchReviewsUrl:function(e){return"".concat(v,"/api/Items/SearchReviews?id=").concat(e)},getReviewsUrl:function(e){return"".concat(v,"/api/Items/Reviews?gr_book_id=").concat(e)},THUMBNAILS_BASE_URL:v+"/Content/Thumbnails/",FINNA_BASE_URL:"https://heili.finna.fi",DELAY_MILLIS:1500},b=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setDefaults",value:function(e){null===e.Locations&&(e.Locations=[]),null===e.Subjects&&(e.Subjects=[])}},{key:"render",value:function(){var e=this.props.item;if(null===e)return i.a.createElement("div",{className:"Details",hidden:!0});this.setDefaults(e);var t=e.Subjects.map(function(e){return e.FullText}).join(" | "),a=e.Locations.map(function(e){return i.a.createElement("li",{key:e.ID},e.Name)}),n=k.FINNA_BASE_URL+e.ExternalRelativeUrl;return i.a.createElement("div",{className:"Details card",hidden:this.props.hidden},i.a.createElement("div",{className:"card-body"},i.a.createElement("button",{className:"DetailsCloseButton btn",onClick:this.props.handleCloseButtonClicked},"\xd7"),i.a.createElement("h3",null,i.a.createElement("span",{className:"AuthorName"},e.AuthorName),i.a.createElement("br",null),e.Title),i.a.createElement("div",null,e.PublicationYear),i.a.createElement("div",null,e.Series),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md"},i.a.createElement("p",{className:"Subjects"},t),i.a.createElement("p",null,"Heili-kirjastot, joiden kokoelmiin nimike kuuluu:"),i.a.createElement("ul",null,a),i.a.createElement("p",null,"Tarkista t\xe4m\xe4nhetkinen saatavuus ",i.a.createElement("a",{href:n},"Finnasta"),".")),i.a.createElement("div",{className:"col-md"},i.a.createElement(d,{reviews:this.props.reviews})))))}}]),t}(n.Component),p=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).clicked=a.clicked.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"clicked",value:function(e){this.props.handleClick(this.props.item)}},{key:"render",value:function(){var e=this.props.item;return i.a.createElement("img",{key:e.ID,src:k.THUMBNAILS_BASE_URL+e.ExternalID+".png",className:"Thumbnail img-fluid img-thumbnail",alt:e.Title,onClick:this.clicked})}}]),t}(n.Component),f=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={detailsHidden:!0,detailsItem:null,reviews:null},a.handleThumbnailClick=a.handleThumbnailClick.bind(Object(h.a)(Object(h.a)(a))),a.handleDetailsCloseButtonClicked=a.handleDetailsCloseButtonClicked.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleThumbnailClick",value:function(e){this.setState({detailsHidden:!1,detailsItem:e,reviews:null}),this.getReviewsID(e)}},{key:"handleDetailsCloseButtonClicked",value:function(e){this.setState({detailsHidden:!0,detailsItem:null})}},{key:"render",value:function(){var e=this,t=this.props.category.Items.map(function(t){return i.a.createElement(p,{key:t.ID,item:t,handleClick:e.handleThumbnailClick})});return i.a.createElement("div",{className:"Category"},i.a.createElement("h2",null,this.props.category.Name),i.a.createElement("div",{className:"Slider"},t),i.a.createElement(b,{item:this.state.detailsItem,reviews:this.state.reviews,hidden:this.state.detailsHidden,handleCloseButtonClicked:this.handleDetailsCloseButtonClicked}))}},{key:"getReviewsID",value:function(e){var t=this,a=k.searchReviewsUrl(e.ID);console.log(a),fetch(a).then(function(e){if(e.ok)return e.json();throw new Error("Request failed: "+e.status)}).then(function(e){console.log(e),e.NumResults>0&&setTimeout(function(){t.getReviews(e)},k.DELAY_MILLIS)}).catch(function(e){console.log("Error retrieving data: ",e.message)})}},{key:"getReviews",value:function(e){var t=this,a=k.getReviewsUrl(e.BestMatch.BookID);console.log(a),fetch(a).then(function(e){if(e.ok)return e.json();throw new Error("Request failed: "+e.status)}).then(function(e){console.log(e),t.setState({reviews:e.Reviews})}).catch(function(e){console.log("Error retrieving data: ",e.message)})}}]),t}(n.Component),j=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("h2",null,"Tietoja Bochus-palvelusta"),i.a.createElement("p",null,"Bochus sis\xe4lt\xe4\xe4 pienen valikoiman Etel\xe4-Karjalan ",i.a.createElement("a",{href:"https://heili.finna.fi/"},"Heili-kirjastojen")," kokoelmista. Palvelun etusivu esittelee t\xe4st\xe4 aineistosta poimittuja teoksia avainsanojen tai lajityypin mukaan ryhmiteltyn\xe4."),i.a.createElement("p",null,"Valitsemalla nimikkeen n\xe4et muun muassa kirjastot, joiden kokoelmiin teos kuuluu. Lis\xe4ksi saatetaan n\xe4ytt\xe4\xe4 ",i.a.createElement("a",{href:"https://www.goodreads.com/"},"Goodreads-sivustolta")," per\xe4isin olevaa lis\xe4tietoa kuten k\xe4ytt\xe4jien arvosteluja."),i.a.createElement("p",null,"Bochus k\xe4ytt\xe4\xe4 Finna.fi- ja Goodreads-sivustojen julkisia rajapintoja, mutta ei ole niiden tai Heili-kirjastojen hyv\xe4ksym\xe4 tai suosittelema."),i.a.createElement("p",null,"P.S. Muinaisenglannin ",i.a.createElement("i",null,i.a.createElement("a",{href:"https://en.wiktionary.org/wiki/bochus"},"b\u014dch\u016bs"))," tarkoitti \u201dkirjastoa\u201d."))}}]),t}(n.Component),E=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleClick",value:function(e){this.props.handleOpenPage(e.currentTarget.dataset.target)}},{key:"render",value:function(){return i.a.createElement("nav",{className:"navbar navbar-expand-md navbar-dark bg-dark fixed-top"},i.a.createElement("a",{className:"navbar-brand",onClick:this.handleClick,"data-target":"MainPage",href:"#"},"Bochus"),i.a.createElement("ul",{className:"navbar-nav mr-auto"},i.a.createElement("li",{className:"nav-item"},i.a.createElement("a",{className:"nav-link",onClick:this.handleClick,"data-target":"AboutPage",href:"#"},"Tietoja"))))}}]),t}(n.Component),g=(a(19),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={categories:[],activePage:"MainPage"},a.setActivePage=a.setActivePage.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"setActivePage",value:function(e){this.setState({activePage:e})}},{key:"componentDidMount",value:function(){var e=this;fetch(k.RECOMMENDATIONS_ENDPOINT).then(function(e){if(e.ok)return e.json();throw new Error("Request failed")}).then(function(t){e.setState({categories:t})}).catch(function(e){console.log("Error retrieving data: ",e.message)})}},{key:"render",value:function(){var e=this.state.categories.map(function(e){return i.a.createElement(f,{key:e.Name,category:e})});return i.a.createElement("div",{className:"App container"},i.a.createElement(E,{handleOpenPage:this.setActivePage}),i.a.createElement("div",{id:"MainPage",hidden:"MainPage"!==this.state.activePage},e),i.a.createElement("div",{id:"AboutPage",hidden:"AboutPage"!==this.state.activePage},i.a.createElement(j,null)))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,a){e.exports=a(21)}},[[9,2,1]]]);
//# sourceMappingURL=main.f3f66f6d.chunk.js.map